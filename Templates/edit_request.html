{% extends "base.html" %}

{% block title %}Edit Rental Request - Rented{% endblock %}

{% block content %}
<div class="container">
  <!-- Edit Request Card -->
  <div style="background: #111; padding: 24px; border-radius: 12px; margin-top: 24px; max-width: 600px; margin-left: auto; margin-right: auto;">
    <h2 style="color: #fff; margin-bottom: 16px;">Edit Your Rental Request</h2>

    <!-- Flash messages -->
    {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      <div style="margin-bottom: 16px;">
        {% for category, message in messages %}
          <div style="padding: 10px; border-radius: 8px; margin-bottom: 8px; 
                      color: #fff;
                      {% if category == 'success' %}background: #28a745;{% endif %}
                      {% if category == 'error' %}background: #dc3545;{% endif %}
                      {% if category == 'warning' %}background: #ffc107; color: #000;{% endif %}
                      {% if category == 'info' %}background: #17a2b8;{% endif %}">
            {{ message }}
          </div>
        {% endfor %}
      </div>
    {% endif %}
    {% endwith %}

    <!-- Edit Request Form -->
    <form method="POST" action="{{ url_for('edit_request', request_id=rent_request.id) }}">
      <label for="days" style="color: #ccc; font-weight: bold;">Number of Days</label>
      <input type="number" id="days" name="days" min="1" required value="{{ rent_request.days }}"
             style="width: 100%; padding: 10px; margin-bottom: 16px; background: #171414; color: #fff; border-radius: 8px; border: 1px solid #333;">

      <label for="description" style="color: #ccc; font-weight: bold;">Additional Notes</label>
      <textarea id="description" name="description" rows="5"
                style="width: 100%; padding: 10px; margin-bottom: 16px; background: #171414; color: #fff; border-radius: 8px; border: 1px solid #333;">{{ rent_request.description }}</textarea>

      <div style="display: flex; justify-content: space-between; align-items: center;">
        <a href="{{ url_for('view_listing', id=rent_request.listing_id) }}" 
           style="padding: 10px 20px; border-radius: 8px; background: #6c757d; color: #fff; text-decoration: none; font-weight: bold;">
          Cancel
        </a>
        <button type="submit" 
                style="padding: 10px 20px; border-radius: 8px; background: #ffc107; color: #000; font-weight: bold; border: none; cursor: pointer;">
          ✏️ Update Request
        </button>
      </div>

      {% if rent_request.status == "Rejected" %}
      <p style="margin-top: 16px; color: #dc3545;">
        This request was previously rejected. Updating it will resubmit it as a new pending request.
      </p>
      {% endif %}
    </form>

    <p style="margin-top: 12px; font-size: 12px; color: #999;">Created: {{ rent_request.created_at|timeago }}</p>
  </div>
</div>
{% endblock %}
